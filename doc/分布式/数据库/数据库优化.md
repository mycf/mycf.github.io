#面试 
# 硬件
配置越高越好，应用一般是无状态的，可以使用廉价的配置，把能力横向的堆起来。数据库是一种集中式的存储服务，所以对于他的高可用稳定性要求比较高，所以数据库资源是比较昂贵的。如果服务拆分的比较细，数据库实例比较多，建议根据业务场景，稍微的侧重一下，如果有占比比较高的复杂sql查询，那么建议cpu的配置好一点，如果侧重的是大的数据量，但是每条sql都比较简单，建议有个大的缓冲区、大的容量。
# 数据库创建
首先是数据库存储引擎的选择，如果没有强事务的要求，那就使用Myisam引擎。关系数据库强在对事务的支持，但是正因为对事务的支持，它也牺牲了很多的性能，所以如果对事务的要求不是很高，可以不选择Innodb存储引擎，这对性能的提升还是很可观的。

# 数据库的隔离级别
mysql默认使用rr的隔离级别，也就是可重复读。但是线上有很多都是设置为rc的隔离级别，也就是读已提交，这样可以避免间隙锁的产生，对于高并发写的场景性能提升还是很明显的。但是还要考虑业务上对于幻读的容忍度。越低的隔离级别，锁的代价越少，这样就能提升数据库的并发度。
# 连接数
把日志的写入从随机变为顺序写，把每次事务的持久化改为批量事务的持久化 设置很多缓冲区的大小比如索引缓冲区 表缓冲区 查询的缓冲区 排序的缓冲区等等，但是这些东西更多是dba的运维，开发做了解就行了。
# 创建表
数据库字段选择性能做到更好
char varchar text
datetime timestamp
主键顺序
# 索引
创建和优化
optimizer trace 更详细的排查
# 存储架构
不要一上来就分表分库，
先优化索引，再看看能不能加缓存，看能不能用异步化，最后才会看分库分表。这个运维的成本是逐步增加的，不要一上来就分库分表，除非有一些大公司，前期分库分表的运维成本很低，可以做一些前瞻性设计，但是绝大部分中小型公司，建议先优化索引，用一个比较低成本，就能得到一个比较大的收益了。

## 分库分表
分表更多的解决单表数据量太大，索引效率太低，是为了优化索引的效率，所以把表拆分。
分库是解决并发量太大，导致连接数不够用了。
分库不止可以水平分，也可以读写分离。但是要考虑主从延时对业务的影响。
分表也不止可以水平分，也可以周期性做冷热分离，这些都是备选方案。
总之我们就是用尽量低的成本，达到一个比较高的收益，一定要考虑投入产出比。
还有关于数据库的反范式设计，要求字段冗余，可以查询起来更方便，但是写入的事务也拉大了，甚至会引入分布式事务的问题，这里又要考虑业务场景对一致性的要求有多高，读写的占比有多大。只有这些都考虑到了之后，才能设计好反范式