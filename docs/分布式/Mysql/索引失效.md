# 有哪些情况会导致索引失效？

这里回答基于最新MySQL8版本，MySQL8失效的以前版本也失效，MySQL8不失效的，以前可能会失效。

● 使用like并且是左边带%, 右边可以带会走索引（但是并不绝对，详细解释看下面like专题分析）
● 隐式类型转换，索引字段与条件或关联字段的类型不一致。（比如你的字段是int，你用字符串方式去查询会导致索引失效）。
● 在where条件里面对索引列使用运算或者使用函数。
● 使用OR且存在非索引列
● 在where条件中两列做比较会导致索引失效
● 使用IN可能不会走索引（MySQL环境变量`eq_range_index_dive_limit`的值对IN语法有很大影响，该参数表示使用索引情况下IN中参数的最大数量。MySQL 5.7.3以及之前的版本中，`eq_range_index_dive_limit`的默认值为10，之后的版本默认值为200。我们拿MySQL8.0.19举例，eq_range_index_dive_limit=200表示当IN (...)中的值 >200个时，该查询一定不会走索引。<=200则可能用到索引。）
● 使用非主键范围条件查询时，部分情况索引失效 。
● 使用order by可能会导致索引失效
● `is null` `is not null` `≠` 可能会导致索引失效

# 如果表中有字段为NULL 索引是否会失效？
![image.png](https://gitee.com/ycfan/images/raw/master/img/20240113224420.png)

首先讲答案不一定。即使我们使用`is null` 或者`is not null` 它其实都是会走索引的。那为什么会有这样的言论呢？这里首先就得来讲讲NULL值是怎么在记录中存储的，又是怎么在B+树中存储的呢。

那么在InnoDB中分为聚簇索引和非聚簇索引两种，聚簇索引本身是不允许记录为空的，所以可以不不用考虑，那么就剩下非聚簇索引也就是我们的辅助索引。

那既然`IS NULL`、`IS NOT NULL`、`!=`这些条件都可能使用到索引，那到底什么时候索引，什么时候采用全表扫描呢？

首先我们得知道两个东西，第一个在InnoDB引擎是如何存储NULL值的，第二个问题是索引是如何存储NULL值的，这样我们才能从根上理解NULL在什么场景走索引，在什么场景不走索引。
